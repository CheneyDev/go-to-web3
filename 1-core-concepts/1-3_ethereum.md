# 1.3: 以太坊 (Ethereum)

如果说比特币是“去中心化的数字黄金”，那么以太坊就是“世界计算机”。它将区块链技术从一个简单的支付网络，提升到了一个可以运行任意复杂程序的去中心化应用平台。

---

## 1. 从“数字黄金”到“世界计算机”的演进

比特币的设计目标非常明确：成为一个点对点的电子现金系统。它的脚本语言功能有限，故意设计得不“图灵完备”，以保证网络的安全性和简单性。

以太坊的创始人 Vitalik Buterin 认为，区块链的潜力远不止于此。他设想了一个平台，开发者可以在上面构建和部署任何他们能想到的去中心化应用（dApp），而不仅仅是货币。

为了实现这个目标，以太坊引入了两个核心创新：
1.  **图灵完备的智能合约**：允许开发者编写可以执行任意复杂逻辑的代码。
2.  **以太坊虚拟机 (EVM)**：一个统一的、沙盒化的运行时环境，用于在所有节点上以相同的方式执行这些代码。

这使得以太坊从一个“账本”进化成了一个可编程的“状态机”，任何应用的状态（例如，一个 DeFi 协议里的借贷关系，或者一个 NFT 的所有权）都可以被记录和更新。

## 2. 账户模型 vs. UTXO 模型

与比特币的 UTXO 模型不同，以太坊采用了更直观的**账户模型 (Account Model)**，这更接近我们熟悉的银行账户。

-   **外部账户 (Externally Owned Accounts, EOA)**：
    -   由**私钥**控制，就像你的个人银行账户。
    -   可以发起交易（发送以太币或调用合约）。
    -   我们日常使用的钱包（如 MetaMask）管理的都是 EOA。

-   **合约账户 (Contract Accounts)**：
    -   由其**代码**控制，没有私钥。
    -   当它们收到一笔交易时，会自动执行其内部的代码逻辑。
    -   例如，一个 Uniswap 的交易对就是一个合约账户。

**对比**：

| 特性 | 比特币 (UTXO 模型) | 以太坊 (账户模型) |
| :--- | :--- | :--- |
| **状态** | 分散在无数的 UTXO 中 | 集中在每个账户的 `state` 中 |
| **直观性** | 较低，像处理现金 | 很高，像处理银行余额 |
| **效率** | 处理复杂逻辑时效率低 | 更容易实现和管理复杂的状态 |
| **并行性** | UTXO 天然支持并行处理交易 | 账户模型可能导致对同一账户的争用 |

## 3. 智能合约 (Smart Contracts)

智能合约是以太坊的灵魂。

-   **定义**：它是一段部署在区块链上的程序，它定义了一套规则和条件。当特定条件被满足时，合约代码会自动执行。
-   **特性**：
    -   **不可变 (Immutable)**：一旦部署，合约代码通常不能被修改。这既是优点（可信）也是缺点（Bug 修复困难）。
    -   **确定性 (Deterministic)**：给定相同的输入和状态，合约在任何节点上执行的结果必须完全相同。
    -   **可组合性 (Composable)**：一个智能合约可以调用另一个智能合约，就像乐高积木一样，可以组合起来构建出非常复杂的应用。这是 DeFi 蓬勃发展的关键。

**例子**：一个简单的自动售货机合约。
-   **规则**：任何人向合约地址发送 1 个 ETH，合约就会自动将 100 个代币发送回该人的地址。
-   **执行**：这段逻辑被写在代码里，公开透明，由网络自动强制执行，无需任何人工干预。

## 4. EVM (以太坊虚拟机)

EVM 是执行智能合约代码的引擎。

-   **目标**：为智能合约提供一个**沙盒环境**。这意味着合约代码与主机的操作系统、文件系统等完全隔离，保证了网络的安全。
-   **工作方式**：
    1.  开发者使用 Solidity 等高级语言编写智能合约。
    2.  代码被编译成 EVM 能理解的低级指令，称为**操作码 (Opcodes)**。
    3.  当一个交易调用合约时，网络中的每个全节点都会在自己的 EVM 实例中执行这些操作码，从而更新区块链的状态。

可以把 EVM 想象成一个去中心化的、全球共享的计算引擎，它确保了无论在世界哪个角落，合约的执行结果都是一致的。

## 5. Gas 的概念：交易成本

在以太坊这个“世界计算机”上运行程序不是免费的。你需要为消耗的计算资源支付费用，这个费用就是 **Gas**。

-   **为什么需要 Gas？**
    -   **防止滥用**：如果没有成本，攻击者可以轻易地编写一个无限循环的合约来瘫痪整个网络。Gas 使得每一次计算步骤都有成本，从而阻止了这种情况。
    -   **激励矿工/验证者**：Gas 费用是支付给打包你交易的验证者的报酬，激励他们为网络提供算力和安全性。

-   **Gas 是如何计算的？**
    一笔交易的总费用由两个因素决定：
    -   `Gas Used`：执行这笔交易（例如，一次加法、一次存储）总共消耗了多少计算单元。复杂的操作消耗更多的 Gas。
    -   `Gas Price`：你愿意为**每一个**计算单元支付多少钱。Gas Price 以 `Gwei` 为单位（1 Gwei = 10^-9 ETH）。

    **交易费 (Tx Fee) = Gas Used * Gas Price**

在网络拥堵时，用户会提高他们的 Gas Price，以竞争让自己的交易被更快地打包。这就像一个拍卖市场，价高者优先。 